<!DOCTYPE html><html lang="en-us" >

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="Source Themes Academic 4.8.0">

  

  
  
  
  
  
    
    
    
  
  

  <meta name="author" content="Paul Apivat">

  
  
  
    
  
  <meta name="description" content="Gaining an intuition for probability using Python">

  
  <link rel="alternate" hreflang="en-us" href="/post/dsfs_6/">

  


  
  
  
  <meta name="theme-color" content="#E32626">
  

  
  

  
  
  
  
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.6/css/academicons.min.css" integrity="sha256-uFVgMKfistnJAfoCUQigIl+JfUaP47GrRKjf6CTPVmw=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.0-1/css/all.min.css" integrity="sha256-4w9DunooKSr3MFXHXWyFER38WmPdm361bQS/2KUWZbU=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous">

    
    
    
      
    
    
      
      
        
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/github.min.css" crossorigin="anonymous" title="hl-light">
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/dracula.min.css" crossorigin="anonymous" title="hl-dark" disabled>
        
      
    

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.5.1/leaflet.css" integrity="sha256-SHMGCYmST46SoyGgo4YR/9AlK1vf3ff84Aq9yK4hdqM=" crossorigin="anonymous">
    

    

    
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/lazysizes/5.1.2/lazysizes.min.js" integrity="sha256-Md1qLToewPeKjfAHU1zyPwOutccPAm5tahnaw7Osw0A=" crossorigin="anonymous" async></script>
      
    
      

      
      

      
    
      

      
      

      
    
      

      
      
        
      

      
    
      

      
      

      
    

  

  
  
  
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Domine:wght@400;700&display=swap">
  

  
  
  
  
  <link rel="stylesheet" href="/css/academic.css">

  




  


  
  

  

  <link rel="manifest" href="/index.webmanifest">
  <link rel="icon" type="image/png" href="/images/icon_hu0b7a4cb9992c9ac0e91bd28ffd38dd00_9727_32x32_fill_lanczos_center_2.png">
  <link rel="apple-touch-icon" type="image/png" href="/images/icon_hu0b7a4cb9992c9ac0e91bd28ffd38dd00_9727_192x192_fill_lanczos_center_2.png">

  <link rel="canonical" href="/post/dsfs_6/">

  
  
  
  
  
  
  
    
    
  
  
  <meta property="twitter:card" content="summary">
  
  <meta property="twitter:site" content="@paulapivat">
  <meta property="twitter:creator" content="@paulapivat">
  
  <meta property="og:site_name" content="Paul Apivat">
  <meta property="og:url" content="/post/dsfs_6/">
  <meta property="og:title" content="Data Science from Scratch (ch6) - Probability | Paul Apivat">
  <meta property="og:description" content="Gaining an intuition for probability using Python"><meta property="og:image" content="/images/icon_hu0b7a4cb9992c9ac0e91bd28ffd38dd00_9727_512x512_fill_lanczos_center_2.png">
  <meta property="twitter:image" content="/images/icon_hu0b7a4cb9992c9ac0e91bd28ffd38dd00_9727_512x512_fill_lanczos_center_2.png"><meta property="og:locale" content="en-us">
  
    
      <meta property="article:published_time" content="2020-11-22T00:00:00&#43;00:00">
    
    <meta property="article:modified_time" content="2020-11-22T00:00:00&#43;00:00">
  

  


    






  




<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "/post/dsfs_6/"
  },
  "headline": "Data Science from Scratch (ch6) - Probability",
  
  "datePublished": "2020-11-22T00:00:00Z",
  "dateModified": "2020-11-22T00:00:00Z",
  
  "author": {
    "@type": "Person",
    "name": "Paul Apivat"
  },
  
  "publisher": {
    "@type": "Organization",
    "name": "Paul Apivat",
    "logo": {
      "@type": "ImageObject",
      "url": "/images/icon_hu0b7a4cb9992c9ac0e91bd28ffd38dd00_9727_192x192_fill_lanczos_center_2.png"
    }
  },
  "description": "Gaining an intuition for probability using Python"
}
</script>

  

  


  


  





  <title>Data Science from Scratch (ch6) - Probability | Paul Apivat</title>

</head>

<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" >

  <aside class="search-results" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        <input name="q" id="search-query" placeholder="Search..." autocapitalize="off"
        autocomplete="off" autocorrect="off" spellcheck="false" type="search">
        
      </div>

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>


  







<nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id="navbar-main">
  <div class="container">

    
    <div class="d-none d-lg-inline-flex">
      <a class="navbar-brand" href="/">Paul Apivat</a>
    </div>
    

    
    <button type="button" class="navbar-toggler" data-toggle="collapse"
            data-target="#navbar-content" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
    <span><i class="fas fa-bars"></i></span>
    </button>
    

    
    <div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none">
      <a class="navbar-brand" href="/">Paul Apivat</a>
    </div>
    

    
    
    <div class="navbar-collapse main-menu-item collapse justify-content-start" id="navbar-content">

      
      <ul class="navbar-nav d-md-inline-flex">
        

        

        
        
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/#"><span>Start Here</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#about"><span>About</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#posts"><span>Posts</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#gallery"><span>Data Viz</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/courses/"><span></span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/technical_notes/"><span>Technical Notes</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#contact"><span>Contact</span></a>
        </li>

        
        

      

        
      </ul>
    </div>

    <ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2">
      
      <li class="nav-item">
        <a class="nav-link js-search" href="#" aria-label="Search"><i class="fas fa-search" aria-hidden="true"></i></a>
      </li>
      

      
      <li class="nav-item dropdown theme-dropdown">
        <a href="#" class="nav-link js-theme-selector" data-toggle="dropdown" aria-haspopup="true">
          <i class="fas fa-palette" aria-hidden="true"></i>
        </a>
        <div class="dropdown-menu">
          <a href="#" class="dropdown-item js-set-theme-light">
            <span>Light</span>
          </a>
          <a href="#" class="dropdown-item js-set-theme-dark">
            <span>Dark</span>
          </a>
          <a href="#" class="dropdown-item js-set-theme-auto">
            <span>Automatic</span>
          </a>
        </div>
      </li>
      

      

    </ul>

  </div>
</nav>


  <article class="article">

  












  

  
  
  
<div class="article-container pt-3">
  <h1>Data Science from Scratch (ch6) - Probability</h1>

  
  <p class="page-subtitle">Conditional Probability &amp; Bayes Theorem</p>
  

  
    


<div class="article-metadata">

  
  
  
  
  <div>
    

  
  <span><a href="/author/paul-apivat/">Paul Apivat</a></span>
  </div>
  
  

  
  <span class="article-date">
    
    
      
    
    Nov 22, 2020
  </span>
  

  

  
  <span class="middot-divider"></span>
  <span class="article-reading-time">
    25 min read
  </span>
  

  
  
  

  
  

</div>

    














  
</div>



  <div class="article-container">

    <div class="article-style">
      <h3 id="table-of-contents">Table of contents</h3>
<ul>
<li>
<a href="#challenge">Challenge</a></li>
<li>
<a href="#marginal_and_joint_probabilities">Marginal and Joint Probability</a></li>
<li>
<a href="#conditional_probability">Conditional Probability</a></li>
<li>
<a href="#bayes_theorem">Bayes&rsquo; Theorem</a></li>
<li>
<a href="#applying_bayes_theorem">Applying Bayes&rsquo; Theorem</a></li>
<li>
<a href="#distributions">Distributions</a></li>
</ul>
<h2 id="overview">Overview</h2>
<h2 id="challenge">Challenge</h2>
<p>The first challenge in this section is distinguishing between <strong>two</strong> conditional probability statements.</p>
<p>Here&rsquo;s the setup. We have a family with two (unknown) children with two assumptions. First, each child is equally likely to be a boy or a girl. Second, the gender of the second child is <em>independent</em> of the gender of the first child.</p>
<blockquote>
<p>Outcome 1: What is the probability of the event &ldquo;both children are girls&rdquo; (B) conditional on the event &ldquo;the older child is a girl&rdquo; (G)?</p>
</blockquote>
<p>The probability for statement one is roughly 50% or (1/2).</p>
<blockquote>
<p>Outcome 2: What is the probability of the event &ldquo;both children are girls&rdquo; (B) conditional on the event &ldquo;at least one of the children is a girl&rdquo; (L)?</p>
</blockquote>
<p>The probability for statement two is roughly 33% or (1/3).</p>
<p>But at first glance, they look similar.</p>
<h2 id="marginal_and_joint_probabilities">Marginal_and_Joint_Probabilities</h2>
<p>The book jumps straight to conditional probabilities, but first, we&rsquo;ll have to look at <strong>marginal</strong> and <strong>joint</strong> probabilities. Then we&rsquo;ll create a <strong>joint probabilities table</strong> and <strong>sum</strong> probabilities to help us figure out the differences. We&rsquo;ll then <em>resume</em> with <strong>conditional probabilities</strong>.</p>
<p>Before anything, we need to realize the situation we have is one of <strong>independence</strong>. The gender of one child is <strong>independent</strong> of a second child.</p>
<p>The intuition for this scenario will be different from a <strong>dependent</strong> situation. For example, if we draw two cards from a deck (without replacement), the probabilities are different. The probability of drawing one King ♠️ is (4/52) and the probability of drawing a second King ♣️ is now (3/51); the probability of the second event (a second King) is <em>dependent</em> on the result of the first draw.</p>
<p>Ok back to the two unknown children.</p>
<p>We can say the probability of the first child being either a boy or a girl is 50/50. Moreover, the probability of the second child, which is <strong>independent</strong> of the first, is <em>also</em> 50/50. Remember, our first assumption is that <em>each child is equally likely to be a boy or a girl</em>.</p>
<p>Let&rsquo;s put these numbers in a table. The (1/2) probabilities shown here are called <strong>marginal</strong> probabilities (note how they&rsquo;re at the margins of the table).</p>
<p><img src="./marginal.png" alt="marginal"></p>
<p>Since we have two gender (much like two sides of a flipped coin), we can intuitively figure out <em>all</em> possible outcomes:</p>
<ol>
<li>first child (Boy), second child (Boy)</li>
<li>first child (Boy), second child (Girl)</li>
<li>first child (Girl), second child (Boy)</li>
<li>first child (Girl), second child (Girl)</li>
</ol>
<p>There are <em>4 possible outcomes</em> so the probability of getting any one of the four outcomes is (1/4). We can actually write these probabilities in the middle of the table, the <strong>joint probabilities</strong>:</p>
<p><img src="./joint.png" alt="joint"></p>
<p>To recap, the probability of the first child being either boy or girl is 50/50, simple enough. The probability of the second child being either boy or girl is also 50/50. When put in a table, this yielded the <strong>marginal probability</strong>.</p>
<p>Now we want to know the probability of say, &lsquo;first child being a boy and second child being a girl&rsquo;. This is a <strong>joint probability</strong> because is is the probability that the first child take a specific gender (boy) <strong>AND</strong> the second child take a specific gender (girl).</p>
<p>If two event are <strong>independent</strong>, and in this case they are, their <strong>joint probabilities</strong> are the <em>product</em> of the probabilities of <strong>each one happening</strong>.</p>
<p>The probability of the first child being a Boy (1/2) <strong>and</strong> second child being a Girl (1/2); The product of each marginal probability is the joint probability (1/2 * 1/2 = 1/4).</p>
<p><img src="./product_marginal.png" alt="product_marginal"></p>
<p>This can be repeated for the other three joint probabilities.</p>
<h2 id="conditional_probability">Conditional_Probability</h2>
<p>Now we get into <strong>conditional probability</strong> which is the probability of one event happening (i.e., second child being a Boy or Girl) <strong>given that</strong> or <strong>on conditional that</strong> another event happened (i.e., first child being a Boy).</p>
<p>At this point, it might be a good idea to get familiar with notation.</p>
<p>A joint probability is the product of each individual event happening (assuming they are independent events). For example we might have two individual events:</p>
<ul>
<li>P(1st Child = Boy): 1/2</li>
<li>P(2nd Child = Boy): 1/2</li>
</ul>
<p>Here is their <strong>joint probability</strong>:</p>
<ul>
<li>P(1st Child = Boy, 2nd Child = Boy) =&gt;</li>
<li>P(1st Child = Boy) * P(2nd Child = Boy) =&gt;</li>
<li>(1/2 * 1/2 = 1/4)</li>
</ul>
<p>There is a relationship between <strong>conditional</strong> probabilities and <strong>joint</strong> probabilities.</p>
<ul>
<li>P(1st Child = Boy | 2nd Child = Boy) = P(1st Child = Boy, 2nd Child = Boy) / P(2nd Child = Boy)</li>
</ul>
<p>Namely, the <strong>conditional</strong> probability is equal to the <strong>joint</strong> probability divided by the conditional.</p>
<p>Thie works out to:</p>
<ul>
<li>P(1st Child = Boy | 2nd Child = Boy) = (1/4) / (1/2)
or</li>
<li>(1/4) * (2/1)
= 1/2</li>
</ul>
<p>In other words, the probability that the second child is a boy, given that the first child is a boy is <em>still</em> 50% (this implies that with respect to <strong>conditional</strong> probability, if the events are <strong>independent</strong> it is not different from a single event).</p>
<p>Now we&rsquo;re ready to tackle the two challenges posed at the beginning of this post.</p>
<blockquote>
<p>Challenge 1: What is the probability of the event &ldquo;both children are girls&rdquo; (B) conditional on the event &ldquo;the older child is a girl&rdquo; (G)?</p>
</blockquote>
<p>Let&rsquo;s break it down. First we want the probability of the event that &ldquo;both children are girls&rdquo;. We&rsquo;ll take the product of two events; the probability that the first child is a girl (1/2) and the probability that the second child is a girl (1/2). So the  <strong>joint probability of both</strong> child being girls is 1/2 * 1/2 = 1/4</p>
<ul>
<li>P(1st Child = Girl, 2nd Child = Girl) = 1/4</li>
</ul>
<p>Second, we want that to be <strong>given that</strong> the &ldquo;older child is a girl&rdquo;.</p>
<ul>
<li>P(1st Child = Girl) = 1/2</li>
</ul>
<p><strong>Conditional probability</strong>:</p>
<ul>
<li>
<p>P(Both Child = Girls | 1st Child = Girl) = P(1st Child = Girl, 2nd Child = Girl) / P(1st Child = Girl)</p>
</li>
<li>
<p>P(Both Child = Girls | 1st Child = Girl) = (1/4) / (1/2)</p>
</li>
<li>
<p>(1/4) * (2/1) = <strong>1/2</strong> or roughly <strong>50%</strong></p>
</li>
</ul>
<p>Now let&rsquo;s break down the second challenge:</p>
<blockquote>
<p>Challenge 2: What is the probability of the event &ldquo;both children are girls&rdquo; (B) conditional on the event &ldquo;at least one of the children is a girl&rdquo; (L)?</p>
</blockquote>
<p>Again, we start with &ldquo;both children are girls&rdquo;:</p>
<ul>
<li>P(1st Child = Girl, 2nd Child = Girl) = 1/4</li>
</ul>
<p>Then, we have &ldquo;on condition that at least one of the children is a girl&rdquo;. We&rsquo;ll reference a <strong>joint probability table</strong>. We see that when trying to figure out the probability that &ldquo;at least one of the children is a girl&rdquo;, we rule out the scenario where <strong>both</strong> children are boys. The remaining 3 out of 4 probabilities, fit the condition.</p>
<p><img src="./at_least.png" alt="at least"></p>
<p>The probability of at least one children being a girl is:</p>
<ul>
<li>(1/4) + (1/4) + (1/4) = 3/4</li>
</ul>
<p>So (introducing notation):</p>
<ul>
<li>
<p>P(B) = &ldquo;probability of both child being girls&rdquo; (i.e., 1st Child = Girl, 2nd Child = Girl)</p>
</li>
<li>
<p>P(L) = &ldquo;probability of at least one child being a girl&rdquo;</p>
</li>
<li>
<p>P(B|L) = P(B,L) / P(L)</p>
</li>
<li>
<p>P(B|L) = (1/4) / (3/4) = (1/4) * (4/3) = <strong>1/3</strong> or roughly <strong>33%</strong></p>
</li>
</ul>
<h4 id="key-take-away">Key Take-away</h4>
<p>When two events are <strong>independent</strong>, their <strong>joint probability</strong> is the product of each event:</p>
<ul>
<li>P(E,F) = P(E) * P(F)</li>
</ul>
<p>Their <strong>conditional</strong> probability is the <strong>joint probability</strong> divided by the conditional (i.e., P(F)).</p>
<ul>
<li>P(E|F) = P(E,F) / P(F)</li>
</ul>
<p>And so for our two challenge scenarios, we have:</p>
<p>Challenge 1:</p>
<ul>
<li>B = probability that both children are girls</li>
<li>G = probability that the <em>older</em> children is a girl</li>
</ul>
<p>This can be stated as: P(B|G) = P(B,G) / P(G)</p>
<p>Challenge 2:</p>
<ul>
<li>B = probability that both children are girls</li>
<li>L = probability that <em>at least one</em> children is a girl</li>
</ul>
<p>This can be stated as: P(B|L) = P(B,L) / P(L)</p>
<h4 id="python-code">Python Code</h4>
<p>Now that we have an intuition and have worked out the problem on paper, we can use code to express conditional probability:</p>
<pre><code class="language-python">import enum, random
class Kid(enum.Enum):
    BOY = 0
    GIRL = 1
    
def random_kid() -&gt; Kid:
    return random.choice([Kid.BOY, Kid.GIRL])
    
both_girls = 0
older_girl = 0
either_girl = 0

random.seed(0)
for _ in range(10000):
    younger = random_kid()
    older = random_kid()
    if older == Kid.GIRL:
        older_girl += 1
    if older == Kid.GIRL and younger == Kid.GIRL:
        both_girls += 1
    if older == Kid.GIRL or younger == Kid.GIRL:
        either_girl += 1
        
print(&quot;P(both | older):&quot;, both_girls / older_girl)   # 0.5007089325501317
print(&quot;P(both | either):&quot;, both_girls / either_girl) # 0.3311897106109325
</code></pre>
<p>We can see that code confirms our intuition.</p>
<p>We use a <code>for-loop</code> and <code>range(10000)</code> to randomly simulate 10,000 scenarios. The <code>random_kid</code> function randomly picks either a boy or girl (assumption #1). We set the following variables to start a 0, <code>both_girls</code> (both children are girls); <code>older_girl</code> (first child is a girl); and <code>either_girl</code> (at least one child is a girl).</p>
<p>Then, each of these variables are incremented by 1 through each of the 10,000 loops if it meets certain conditions. After we finish looping, we can call on each of the three variables to see if they match our calculations above:</p>
<pre><code class="language-python">either_girl #7,464 / 10,000 ~ roughly 75% or 3/4 probability that there is at least one girl
both_girls  #2,472 / 10,000 ~ roughly 25% or 1/4 probability that both children are girls
older_girl  #4,937 / 10,000 ~ roughly 50% or 1/2 probability that the first child is a girl
</code></pre>
<p>We will look at Bayes Theorem next.</p>
<h2 id="bayes_theorem">Bayes_Theorem</h2>
<p>Previously, we established an understanding of <strong>conditional</strong> probability, but building up with <strong>marginal</strong> and <strong>joint</strong> probabilities. We explored the conditional probabilities of two outcomes:</p>
<blockquote>
<p>Outcome 1: What is the probability of the event &ldquo;both children are girls&rdquo; (B) conditional on the event &ldquo;the older child is a girl&rdquo; (G)?</p>
</blockquote>
<p>The probability for outcome one is roughly 50% or (1/2).</p>
<blockquote>
<p>Outcome 2: What is the probability of the event &ldquo;both children are girls&rdquo; (B) conditional on the event &ldquo;at least one of the children is a girl&rdquo; (L)?</p>
</blockquote>
<p>The probability for outcome two is roughly 33% or (1/3).</p>
<p><strong>Bayes&rsquo; Theorem</strong> is simply <em>an alternate</em> way of calculating conditional probability.</p>
<p>Previously, we used the <strong>joint</strong> probability to calculate the <strong>conditional</strong> probability.</p>
<h3 id="outcome-1">Outcome 1</h3>
<p>Here&rsquo;s the conditional probability for outcome 1, using a joint probability:</p>
<ul>
<li>
<p>P(G) = &lsquo;Probability that first child is a girl&rsquo; (1/2)</p>
</li>
<li>
<p>P(B) = &lsquo;Probability that both children are girls&rsquo; (1/4)</p>
</li>
<li>
<p>P(B|G) = P(B,G) / P(G)</p>
</li>
<li>
<p>P(B|G) =  (1/4) / (1/2) = <strong>1/2</strong> or roughly <strong>50%</strong></p>
</li>
</ul>
<p>Technically, we <em>can&rsquo;t</em> use joint probability because the two events are <em>not independent</em>.</p>
<p>To clarify, the probability of the older child being a certain gender and the probability of the younger child being a certain gender <em>is</em> independent, but <code>P(B|G)</code> the &lsquo;probability of <em>both</em> child being a girl&rsquo; and &lsquo;the probability of the older child being a girl&rsquo; are <em>not independent</em>; and hence we express it as a <em>conditional</em> probability.</p>
<p>So, the joint probability of <code>P(B,G)</code> is just event B,<code>P(B)</code>.</p>
<p>Here&rsquo;s an alternate way to calculate the conditional probability (<strong>without</strong> joint probability):</p>
<ul>
<li><code>P(B|G) = P(G|B) * P(B) / P(G)</code>  <strong>This is Bayes Theorem</strong></li>
<li>P(B|G) = 1 * (1/4) / (1/2)</li>
<li>P(B|G) = (1/4) * (2/1)</li>
<li>P(B|G) = 1/2 = <strong>50%</strong></li>
</ul>
<p><strong>note</strong>: P(G|B) is &lsquo;the probability that the first child is a girl, given that <strong>both</strong> children are girls is a certainty (1.0)&rsquo;</p>
<p>The <strong>reverse</strong> conditional probability, can also be calculated, without joint probability:</p>
<blockquote>
<p>What is the probability of the older child being a girl, given that both children are girls?</p>
</blockquote>
<ul>
<li><code>P(G|B) = P(B|G) * P(G) / P(B)</code>  <strong>This is Bayes Theorem (reverse case)</strong></li>
<li>P(G|B) = (1/2) * (1/2) / (1/4)</li>
<li>P(G|B) = (1/4) / (1/4)</li>
<li>P(G|B) = 1 = <strong>100%</strong></li>
</ul>
<p>This is consistent with what we already derived above, namely that P(G|B) is a <strong>certainty</strong> (probability = 1.0), that the older child is a girl, <strong>given that</strong> both children are girls.</p>
<p>We can point out two additional observations / rules:</p>
<ol>
<li>While, joint probabilities are <strong>symmetrical</strong>: P(B,G) == P(G,B),</li>
<li>Conditional probabilities are <strong>not symmetrical</strong>: P(B|G) != P(G|B)</li>
</ol>
<h3 id="bayes-theorem-alternative-expression">Bayes&rsquo; Theorem: Alternative Expression</h3>
<p><strong>Bayes Theorem</strong> is a way of calculating conditional probability <em>without</em> the joint probability, summarized here:</p>
<ul>
<li><code>P(B|G) = P(G|B) * P(B) / P(G)</code>  <strong>This is Bayes Theorem</strong></li>
<li><code>P(G|B) = P(B|G) * P(G) / P(B)</code>  <strong>This is Bayes Theorem (reverse case)</strong></li>
</ul>
<p>You&rsquo;ll note that <code>P(G)</code> is the denominator in the former, and <code>P(B)</code> is the denominator in the latter.</p>
<blockquote>
<p>What if, for some reasons, we don&rsquo;t have access to the denominator?</p>
</blockquote>
<p>We could derive both <code>P(G)</code> and <code>P(B)</code> in another way using the <code>NOT</code> operator:</p>
<ul>
<li>P(G) = P(G,B) + P(G,not B) = P(G|B) * P(B) + P(G|not B) * P(not B)</li>
<li>P(B) = P(B,G) + P(B,not G) = P(B|G) * P(G) + P(B|not G) * P(not G)</li>
</ul>
<p>Therefore, the alternative expression of Bayes Theorem for the probability of <em>both</em> children being girls, given that the first child is a girl ( P(B|G) ) is:</p>
<ul>
<li>P(B|G) = P(G|B) * P(B) / ( P(G|B) * P(B) + P(G|not B) * P(not B) )</li>
<li>P(B|G) =     1 * 1/4 / (1 * 1/4 + 1/3 * 3/4)</li>
<li>P(B|G) =  1/4  /  (1/4 + 3/12)</li>
<li>P(B|G) =  1/4  /  2/4  =  1/4 * 4/2</li>
<li>P(B|G) =  1/2 or roughly <strong>50%</strong></li>
</ul>
<p>We can check the result in code:</p>
<pre><code class="language-python">def bayes_theorem(p_b, p_g_given_b, p_g_given_not_b):
   # calculate P(not B)
   not_b = 1 - p_b
   # calculate P(G)
   p_g = p_g_given_b * p_b + p_g_given_not_b * not_b
   # calculate P(B|G)
   p_b_given_g = (p_g_given_b * p_b) / p_g
   return p_b_given_g
   
#P(B)
p_b = 1/4

# P(G|B)
p_g_given_b = 1

# P(G|notB)
p_g_given_not_b = 1/3

# calculate P(B|G)
result = bayes_theorem(p_b, p_g_given_b, p_g_given_not_b)

# print result
print('P(B|G) = %.2f%%' % (result * 100))
</code></pre>
<p>For the probability that the first child is a girl, given that <em>both</em> children are girls ( P(G|B) ) is:</p>
<ul>
<li>P(G|B) = P(B|G) * P(G) / ( P(G|B) * P(G) + P(B|not G) * P(not G) )</li>
<li>P(G|B) =   1/2 * 1/2  / ((1/2 * 1/2) + (0 * 1/2))</li>
<li>P(G|B) =  1/4  /  1/4</li>
<li>P(G|B) = 1</li>
</ul>
<p>Let&rsquo;s unpack Outcome 2.</p>
<h3 id="outcome-2">Outcome 2</h3>
<blockquote>
<p>Outcome 2: What is the probability of the event &ldquo;both children are girls&rdquo; (B) conditional on the event &ldquo;at least one of the children is a girl&rdquo; (L)?</p>
</blockquote>
<p>The probability for outcome two is roughly 33% or (1/3).</p>
<p>We&rsquo;ll go through the same process as above.</p>
<p>We could use <strong>joint</strong> probability to calculate the <strong>conditional</strong> probability. As with the previous outcome, the joint probability of <code>P(B,G)</code> is just event B,<code>P(B)</code>.</p>
<ul>
<li>P(B|L) = P(B,L) / P(L) = 1/3</li>
</ul>
<p>Or, we could use Bayes&rsquo; Theorem to figure out the <strong>conditional</strong> probability <strong>without joint</strong> probability:</p>
<ul>
<li>P(B|L) = P(L|B) * P(B) / P(L)</li>
<li>P(B|L) =  (1 * 1/4) / (3/4)</li>
<li>P(B|L) = 1/3</li>
</ul>
<p>And, if there&rsquo;s no <code>P(L)</code>, we can calculate that indirectly, also using Bayes&rsquo; Theorem:</p>
<ul>
<li>P(L) = P(L|B) * P(B) + P(L|not B) * P(not B)</li>
<li>P(L) =  1 * (1/4) + (2/3) * (3/4)</li>
<li>P(L) =  (1/4) + (2/4)</li>
<li>P(L) = 3/4</li>
</ul>
<p>Then, we can use <code>P(L)</code> in the way Bayes&rsquo; Theorem is commonly expressed, when we don&rsquo;t have the denominator:</p>
<ul>
<li>P(B|L) = P(L|B) * P(B) / ( P(L|B) * P(B) + P(L|not B) * P(not B) )</li>
<li>P(B|L) =  1 * (1/4) / (3/4)</li>
<li>P(B|L) = 1/3</li>
</ul>
<p>Now that we&rsquo;ve gone through the calculation for two conditional probabilities, <code>P(B|G)</code> and <code>P(B|L)</code>, using Bayes Theorem, and implemented code for one of the scenarios, let&rsquo;s take a step back and assess what this <em>means</em>.</p>
<h3 id="bayesian-terminology">Bayesian Terminology</h3>
<p>I think its useful to understand that probability in general shines when we want to describe uncertainty and that Bayes&rsquo; Theorem allows us to quantify how much the data we observe, should change our beliefs.</p>
<p><img src="./bayes_table.png" alt="png"></p>
<p>We have two <strong>posteriors</strong>, <code>P(B|G)</code> and <code>P(B|L)</code>, both with equal <strong>priors</strong> and <strong>likelihood</strong>, but with <em>different</em> <strong>evidence</strong>.</p>
<p>Said differently, we want to know the &lsquo;probability that both children are girls`, given <em>different</em> conditions.</p>
<p>In the first case, our condition is &lsquo;the first child is a girl&rsquo; and in the second case, our condition is &lsquo;<em>at least one</em> of the child is a girl&rsquo;. The question is which condition will increase the probability that <strong>both</strong> children are girls?</p>
<p>Bayes&rsquo; Theorem allows us to update our belief about the probability in these two cases, as we incorporate varied data into our framework.</p>
<p>What the calculations tell us is that the <strong>evidence</strong> that &lsquo;one child is a girl&rsquo; increases the probability that <strong>both</strong> children are girls <em>more than</em> the other piece of <strong>evidence</strong> that &lsquo;at least one child is a girl&rsquo; increases that probability.</p>
<p>And our beliefs should be updated accordingly.</p>
<p>At the end of the day, understanding conditional probability (and Bayes Theorem) comes down to <strong>counting</strong>. For our hypothetical scenarios, we only need one hand:</p>
<p>When we look at the probability table for outcome one, <code>P(B|G)</code>, we can see how the posterior probability comes out to 1/2:</p>
<p><img src="./outcome_one.png" alt="outcome_one"></p>
<p>When we look at the probability table for outcome two, <code>P(B|L)</code>, we can see how the posterior probability comes out to 1/3:</p>
<p><img src="./outcome_two.png" alt="outcome_two"></p>
<p>This is part of an ongoing series documenting my progress through Data Science from Scratch by Joel Grus:</p>
<p><img src="./conditional_prob_ch6.png" alt="png"></p>
<h2 id="applying_bayes_theorem">Applying_Bayes_Theorem</h2>
<p>Now that we have a basic understanding of Bayes Theorem, let&rsquo;s extend the application to a slightly more complex example. This section was inspired by this 
<a href="https://twitter.com/3blue1brown/status/1333121058824613889?s=20" target="_blank" rel="noopener">tweet</a> from Grant Sanderson (of 
<a href="https://www.youtube.com/watch?v=HZGCoVF3YvM" target="_blank" rel="noopener">3Blue1Brown fame</a>):</p>
<p><img src="./grant_tweet.png" alt="grant_tweet"></p>
<p>This is a classic application of Bayes Theorem - the <strong>medical diagnostic scenario</strong>. The above tweet can be re-stated:</p>
<blockquote>
<p>What is the probability of you <em>actually having the disease</em>, given that you tested positive?</p>
</blockquote>
<p>This happens to be even more relevant as we&rsquo;re living through a generational pandemic.</p>
<p>Let&rsquo;s start off with a conceptual understanding, using the tools we learned previously. First, we have to keep in mind <strong>testing</strong> and <strong>actually having the disease</strong> are <strong>not independent</strong> events. Therefore, we will use <strong>conditional probability</strong> to express their joint outcomes.</p>
<p>The intuitive visual to illustrate this is the <strong>tree diagram</strong>:</p>
<p><img src="./initial_tree.png" alt="initial_tree"></p>
<p>The initial given information contains the information in the tree.</p>
<ul>
<li>
<p>P(D): Probability of having the disease (covid-19)</p>
</li>
<li>
<p>P(P): Probability of testing positive</p>
</li>
<li>
<p>*P(D|P): Our objective is to find the probability of having the disease, given a positive test</p>
</li>
<li>
<p>1 in 1,000 actively have covid-19, P(D), this implies&hellip;</p>
</li>
<li>
<p>999 in 1,000 do <strong>not</strong> actively have covid-19, P(not D)</p>
</li>
<li>
<p>1% or 0.01 false positive (given)</p>
</li>
<li>
<p>10% or 0.1 false negative (given)</p>
</li>
</ul>
<p>The <strong>false positive</strong> is when you <em>don&rsquo;t</em> have the disease, but your test (in error) shows up positive. <strong>False negative</strong> is when you <em>have</em> the disease, but your test (in error) shows up negative. We are provided this information and have to calculate other values to fill in the tree.</p>
<p>We know that all possible events have to add up to 1, so if 1 in 1,000 actively have the disease, we know that 999 in 1,000 do not have it. If the false negative is 10%, then the <strong>true positive</strong> is 90%. If the false positive is 1%, then the <strong>true negative</strong> is 99%. From our calculations, the tree can be updated:</p>
<p><img src="./second_tree.png" alt="second_tree"></p>
<p>Now that we&rsquo;ve filled out the tree, we can use <strong>Bayes&rsquo; Theorem</strong> to find <code>P(D|P)</code>. Here&rsquo;s Bayes&rsquo; Theorem that we discussed in the previous section. We have Bayes&rsquo; Theorem, the denominator, probability of testing positive <code>P(P)</code> and the <em>second</em> version of Bayes Theorem in cases were we <em>do not know</em> the probability of testing positive (as in the present case):</p>
<p><img src="./bayes1.png" alt="bayes1"></p>
<p>Then we can plug-in the denominator to get the alternative version of Bayes&rsquo; Theorem:</p>
<p><img src="./bayes2.png" alt="bayes2"></p>
<p>Here&rsquo;s how the numbers add up:</p>
<ul>
<li>P(D|P) = P(P|D) * P(D) / P(P|D) * P(D) + P(P|not D) * P(not D)</li>
<li>P(D|P) = 0.9 * 0.001 / 0.9 * 0.001 + 0.01 * 0.999</li>
<li>P(D|P) = 0.0009 / 0.0009 + 0.00999</li>
<li>P(D|P) = 0.0009 / 0.01089</li>
<li>P(D|P) ~ 0.08264 or 8.26%</li>
</ul>
<p>Interestingly, 
<a href="https://twitter.com/karpathy" target="_blank" rel="noopener">Andrej Karpathy</a> actually 
<a href="https://twitter.com/karpathy/status/1333217287155847169?s=20" target="_blank" rel="noopener">responded in the thread</a> and provided an intuitive way to arrive at the same result using Python.</p>
<p>Here&rsquo;s his code (with added comments):</p>
<pre><code class="language-python">from random import random, seed
seed(0)

pop = 10000000 # 10M people
counts = {}

for i in range(pop):
    has_covid = i % 1000 == 0 # one in 1,000 people have covid (priors or prevalence of disease)
    # The major assumption is that every person gets tested regardless of any symptoms
    if has_covid:                  # Has disease
        tests_positive = True      # True positive
        if random() &lt; 0.1:     
            tests_positive = False # False negative
    else:                          # Does not have disease
        tests_positive = False     # True negative
        if random() &lt; 0.01:    
            tests_positive = True  # False positive
    outcome = (has_covid, tests_positive)
    counts[outcome] = counts.get(outcome, 0) + 1
    
for (has_covid, tested_positive), n in counts.items():
    print('has covid: %6s, tests positive: %6s, count: %d' % (has_covid, tested_positive, n))
    
n_positive = counts[(True, True)] + counts[(False, True)]

print('number of people who tested positive:', n_positive)
print('probability that a test-positive person actually has covid: %.2f' % (100.0 * counts[(True, True)] / n_positive), )
</code></pre>
<p>We first build a hypothetical population of 10 million. If the <strong>prior</strong> or <strong>prevalence</strong> of disease is 1 in 1,000, a population of 10 million should find 10000 people with covid. You can see how this works with this short snippet:</p>
<pre><code class="language-python">pop = 10000000
counts = 0

for i in range(pop):
    has_covid = i % 1000 == 0
    if has_covid:
        counts = counts + 1
print(counts, &quot;people have the disease in a population of 10 million&quot;)
</code></pre>
<p>Nested in the <code>for-loop</code> are <code>if-statements</code> that segment the population (10M) into one of four categories True Positive, False Negative, True Negative, False Positive. Each category is counted and stored in a <code>dict</code> called <code>counts</code>. Then another <code>for-loop</code> is used to loop through this dictionary to print out all the categories:</p>
<pre><code class="language-python">has covid:   True, tests positive:   True, count: 9033
has covid:  False, tests positive:  False, count: 9890133
has covid:  False, tests positive:   True, count: 99867
has covid:   True, tests positive:  False, count: 967

number of people who tested positive: 108900
probability that a test-positive person actually has covid: 8.29
</code></pre>
<p>Finally, we want the number of people who <em>have</em> the disease <em>and</em> tested positive (True Positive, 9033) divided by the number of people who tested positive, regardless of whether they actually have the disease (True Positive (9033) + False Positive (99867) = 108,900) and this comes out to approximately 8.29.</p>
<p>Although the 
<a href="https://twitter.com/karpathy/status/1333217287155847169?s=20" target="_blank" rel="noopener">code</a> was billed as &ldquo;simple code to build intuition&rdquo;, I found that Bayes&rsquo; Theorem <em>is</em> the intuition.</p>
<h3 id="what-about-symptoms">What about symptoms?</h3>
<p>The key to Bayes&rsquo; Theorem is that it encourages us to update our beliefs when presented with new evidence. But what if there&rsquo;s evidence we missed in the first place?</p>
<p>If you look back at the 
<a href="https://twitter.com/3blue1brown/status/1333121058824613889?s=20" target="_blank" rel="noopener">original tweet</a>, there are important details about symptoms that, if we wanted to be more realistic, should be accounted for.</p>
<blockquote>
<p>You feel fatigued and have a slight sore throat.</p>
</blockquote>
<p>Here, instead of assuming that prevalence of the disease (1 in 1,000 people have covid-19) is the prior, we might ask what probability that someone who is symptomatic has the disease?</p>
<p>Let&rsquo;s suppose we change from 1 in 1,000 to 1 in 100. We could change just one line of code (while everything else remains the same):</p>
<pre><code class="language-python">for i in range(pop):
    has_covid = i % 100 == 0 # update info: 1/1000 have covid, but 1/100 with symptoms have covid
</code></pre>
<p>The probability that someone with a positive test actually has the disease jumps from 8.29% to 47.61%</p>
<pre><code class="language-python">has covid:   True, tests positive:   True, count: 180224
has covid:  False, tests positive:  False, count: 19601715
has covid:  False, tests positive:   True, count: 198285
has covid:   True, tests positive:  False, count: 19776
number of people who tested positive: 378509
probability that a test-positive person with symptoms actually has covid: 47.61
</code></pre>
<p>Thus, being symptomatic means our <strong>priors</strong> should be adjusted and our <strong>beliefs</strong> about the likelihood that a positive test means we have the disease (<code>P(D|P)</code>) should be updated accordingly (in this case, it goes way up).</p>
<h3 id="take-aways">Take Aways</h3>
<p>Hypothetically, if we have family or friends living in an area where 1 in 1,000 people have covid-19 and they (god forbid) got tested and got a positive result, you could tell them that their probability of actually having the disease, given a positive test was around 8.26–8.29%.</p>
<p>However, what’s useful about the Bayesian approach is that it encourages us to incorporate new information and update our beliefs accordingly. So if we find out our family or friend is also <em>symptomatic</em>, we could advise them of the higher probability (~47.61%).</p>
<p>Finally, we may also advise our family/friends to get tested <strong>again</strong>, because as much as test-positive person would hope they got a ‘false positive’, chances are low. And even lower, is getting a false positive <em>twice</em>.</p>
<p><img src="./second_test.png" alt="second_test"></p>
<h2 id="distributions">Distributions</h2>
<p>In this post, we&rsquo;ll cover various distributions. This is a broad topic so we&rsquo;ll sample a few concepts to get a feel for it. Borrowing from the previous post, we&rsquo;ll chart our medical diagnostic outcomes.</p>
<p>You&rsquo;ll recall that each outcome is the combination of whether someone has a disease, <code>P(D)</code>, or not, <code>P(not D)</code>. Then, they&rsquo;re given a diagnostic test that returns positive, <code>P(P)</code> or negative, <code>P(not P)</code>.</p>
<p>These are discrete outcomes so they can be represented with the <strong>probability mass function</strong>, as opposed to a <strong>probability density function</strong>, which represent a continuous distribution.</p>
<p>Let&rsquo;s take another <em>hypothetical</em> scenario of a city where 1 in 10 people have a disease and a diagnostic test has a True Positive of 95% and True Negative of 90%. The probability that a test-positive person <em>actually</em> having the disease is 46.50%.</p>
<p>Here&rsquo;s the code:</p>
<pre><code class="language-python">from random import random, seed

seed(0)
pop = 1000  # 1000 people
counts = {}
for i in range(pop):
    has_disease = i % 10 == 0  # one in 10 people have disease
    # assuming that every person gets tested regardless of any symptoms
    if has_disease:
        tests_positive = True       # True Positive  95%
        if random() &lt; 0.05:
            tests_positive = False  # False Negative 5%
    else:
        tests_positive = False      # True Negative  90%
        if random() &lt; 0.1:
            tests_positive = True   # False Positive 10%
    outcome = (has_disease, tests_positive)
    counts[outcome] = counts.get(outcome, 0) + 1

for (has_disease, tested_positive), n in counts.items():
    print('Has Disease: %6s, Test Positive: %6s, count: %d' %
          (has_disease, tested_positive, n))

n_positive = counts[(True, True)] + counts[(False, True)]
print('Number of people who tested positive:', n_positive)
print('Probability that a test-positive person actually has disease: %.2f' %
      (100.0 * counts[(True, True)] / n_positive),)
</code></pre>
<p>Given the probability that someone has the disease (1 in 10), also called the &lsquo;prior&rsquo; in Bayesian terms. We modeled four scenarios where people were given a diagnostic test. Again, the big assumption here is that people get randomly tested. With the true positive and true negative rates stated above, here are the outcomes:</p>
<p><img src="./hypothetical_outcome.png" alt="hypothetical_outcome"></p>
<h3 id="probability-mass-function">Probability Mass Function</h3>
<p>Given these discrete events, we can chart a <strong>probability mass function</strong>, also known as 
<a href="https://en.wikipedia.org/wiki/Probability_mass_function" target="_blank" rel="noopener">discrete density function</a>. We&rsquo;ll import <code>pandas</code> to help us create <code>DataFrames</code> and <code>matplotlib</code> to chart the <strong>probability mass function</strong>.</p>
<p>We first need to turn the counts of events into a <code>DataFrame</code> and change the column to <code>item_counts</code>. Then, we&rsquo;ll calculate the probability of each event by dividing the count by the total number of people in our hypothetical city (i.e., population: 1000).</p>
<p><strong>Optional</strong>: Create another column with abbreviations for test outcome (i.e., &ldquo;True True&rdquo; becomes &ldquo;TT&rdquo;). We&rsquo;ll call this column <code>item2</code>.</p>
<pre><code class="language-python">import pandas as pd
import matplotlib.pyplot as plt

df = pd.DataFrame.from_dict(counts, orient='index')
df = df.rename(columns={0: 'item_counts'})
df['probability'] = df['item_counts']/1000
df['item2'] = ['TT', 'FF', 'FT', 'TF']
</code></pre>
<p>Here is the <code>DataFrame</code> we have so far:</p>
<p><img src="./pmf_df.png" alt="pmf_df"></p>
<p>You&rsquo;ll note that the numbers in the <code>probability</code> column adds up to 1.0 and that the <code>item_counts</code> numbers are the same as the count above when we had calculated the probability of a test-positive person actually having the disease.</p>
<p>We&rsquo;ll use a simple bar chart to chart out the diagnostic probabilities and this is how we&rsquo;d visually represent the probability mass function - probabilities of each discrete event; each &lsquo;discrete event&rsquo; is a conditional (e.g., probability that someone has a positive test, given that they <em>have</em> the disease - TT or probability that someone has a negative test, given that they <em>don&rsquo;t have</em> the disease - FF, and so on).</p>
<p><img src="./prob_mass_function.png" alt="prob_mass_function.png"></p>
<p>Here&rsquo;s the code:</p>
<pre><code class="language-python">df = pd.DataFrame.from_dict(counts, orient='index')
df = df.rename(columns={0: 'item_counts'})
df['probability'] = df['item_counts']/1000
df['item2'] = ['TT', 'FF', 'FT', 'TF']
plt.bar(df['item2'], df['probability'])
plt.title(&quot;Probability Mass Function&quot;)
plt.show()
</code></pre>
<h3 id="cumulative-distribution-function">Cumulative Distribution Function</h3>
<p>While the probability mass function can tell us the probability of each discrete event (i.e., TT, FF, FT, and TF) we can also represent the same information as a <strong>cumulative distribution function</strong> which allows us to see how the probability changes as we add events together.</p>
<p>The cumulative distribution function simply adds the probability from the previous row in a <code>DataFrame</code> in a cumulative fashion, like in the column <code>probability2</code>:</p>
<p><img src="./cdf_df.png" alt="cdf_df.png"></p>
<p>We use the <code>cumsum()</code> function to create the <code>cumsum</code> column which is simply adding the <code>item_counts</code>, with each successive row. When we create the corresponding probability column, <code>probability2</code>, it gets larger until we reach 1.0.</p>
<p>Here&rsquo;s the chart:</p>
<p><img src="./cum_distri_function.png" alt="cum_distri_function"></p>
<p>This chart tells us that the probability of getting both TT and FF (True, True = True Positive, and False, False = True Negative) is 88.6% which indicates that 11.4% (100 - 88.6) of the time, the diagnostic test will let us down.</p>
<h3 id="normal-distribution">Normal Distribution</h3>
<p>More often than not, you&rsquo;ll be interested in <em>continuous</em> distributions and you can see better see how the <strong>cumulative distribution function</strong> works.</p>
<p>You&rsquo;re probably familiar with the bell shaped curve or the <em>normal distribution</em>, defined solely by its mean (mu) and standard deviation (sigma). If you have a <strong>standard normal distribution</strong> of probability values, the average would be 0 and the standard deviation would be 1.</p>
<p><img src="./1_normal.png" alt="1_normal"></p>
<p>Code:</p>
<pre><code class="language-python">import math
SQRT_TWO_PI = math.sqrt(2 * math.pi)

def normal_pdf(x: float, mu: float = 0, sigma: float = 1) -&gt; float:
    return (math.exp(-(x-mu) ** 2 / 2 / sigma ** 2) / (SQRT_TWO_PI * sigma))
    
# plot
xs = [x / 10.0 for x in range(-50, 50)]
plt.plot(xs, [normal_pdf(x, sigma=1) for x in xs], '-', label='mu=0, sigma=1')
plt.show()
</code></pre>
<p>With the <strong>standard normal distribution</strong> curve, you see the average probability is around 0.4. But if you add up the area under the curve (i.e., all probabilities of every possible outcome), you would get 1.0, just like with the medical diagnostic example.</p>
<p>And if you split the bell in half, then flip over the left half, you&rsquo;ll (visually) get the <strong>cumulative distribution function</strong>:</p>
<p><img src="./1_cumu.png" alt="1_cumu"></p>
<p>Code:</p>
<pre><code class="language-python">import math

def normal_cdf(x: float, mu: float = 0, sigma: float = 1) -&gt; float:
    return (1 + math.erf((x - mu) / math.sqrt(2) / sigma)) / 2
    
# plot
xs = [x / 10.0 for x in range(-50, 50)]
plt.plot(xs, [normal_cdf(x, sigma=1) for x in xs], '-', label='mu=0,sigma=1')
</code></pre>
<p>In both cases, the area under the curve for the <strong>standard normal distribution</strong> and the <strong>cumulative distribution function</strong> is 1.0, thus summing the probabilities of all events is one.</p>
<p>For more content on data science, machine learning, R, Python, SQL and more, 
<a href="https://twitter.com/paulapivat" target="_blank" rel="noopener">find me on Twitter</a>.</p>

    </div>

    





<div class="article-tags">
  
  <a class="badge badge-light" href="/tag/python/">Python</a>
  
  <a class="badge badge-light" href="/tag/data-science/">Data Science</a>
  
  <a class="badge badge-light" href="/tag/statistics/">Statistics</a>
  
  <a class="badge badge-light" href="/tag/probability/">Probability</a>
  
</div>



<div class="share-box" aria-hidden="true">
  <ul class="share">
    
      
      
      
        
      
      
      
      <li>
        <a href="https://twitter.com/intent/tweet?url=/post/dsfs_6/&amp;text=Data%20Science%20from%20Scratch%20%28ch6%29%20-%20Probability" target="_blank" rel="noopener" class="share-btn-twitter">
          <i class="fab fa-twitter"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.facebook.com/sharer.php?u=/post/dsfs_6/&amp;t=Data%20Science%20from%20Scratch%20%28ch6%29%20-%20Probability" target="_blank" rel="noopener" class="share-btn-facebook">
          <i class="fab fa-facebook"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="mailto:?subject=Data%20Science%20from%20Scratch%20%28ch6%29%20-%20Probability&amp;body=/post/dsfs_6/" target="_blank" rel="noopener" class="share-btn-email">
          <i class="fas fa-envelope"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.linkedin.com/shareArticle?url=/post/dsfs_6/&amp;title=Data%20Science%20from%20Scratch%20%28ch6%29%20-%20Probability" target="_blank" rel="noopener" class="share-btn-linkedin">
          <i class="fab fa-linkedin-in"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="whatsapp://send?text=Data%20Science%20from%20Scratch%20%28ch6%29%20-%20Probability%20/post/dsfs_6/" target="_blank" rel="noopener" class="share-btn-whatsapp">
          <i class="fab fa-whatsapp"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://service.weibo.com/share/share.php?url=/post/dsfs_6/&amp;title=Data%20Science%20from%20Scratch%20%28ch6%29%20-%20Probability" target="_blank" rel="noopener" class="share-btn-weibo">
          <i class="fab fa-weibo"></i>
        </a>
      </li>
    
  </ul>
</div>












  
    
    





  
    
    
    
      
    
    
    
    <div class="media author-card content-widget-hr">
      
        
        <img class="avatar mr-3 avatar-circle" src="/author/paul-apivat/red_avatar_hu0c517471d0b79549aa4916e17cd3b5ba_149737_270x270_fill_q90_lanczos_center.jpg" alt="Paul Apivat">
      

      <div class="media-body">
        <h5 class="card-title"><a href="/">Paul Apivat</a></h5>
        <h6 class="card-subtitle">web3</h6>
        <p class="card-text">My interests include data science, machine learning and R/Python programming.</p>
        <ul class="network-icon" aria-hidden="true">
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="/#contact" >
        <i class="fas fa-envelope"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://twitter.com/paulapivat" target="_blank" rel="noopener">
        <i class="fab fa-twitter"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://www.linkedin.com/in/paulapivat/" target="_blank" rel="noopener">
        <i class="fab fa-linkedin"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://github.com/paulapivat" target="_blank" rel="noopener">
        <i class="fab fa-github"></i>
      </a>
    </li>
  
</ul>

      </div>
    </div>
  


  










  
  
  <div class="article-widget content-widget-hr">
    <h3>Related</h3>
    <ul>
      
      <li><a href="/post/dsfs_7/">Data Science from Scratch (ch7) - Hypothesis and Inference</a></li>
      
      <li><a href="/post/statistics_probability/">Statistics &amp; Probability in Code</a></li>
      
      <li><a href="/post/sentiment_analysis/">How Positive are Your Facebook Posts?</a></li>
      
      <li><a href="/post/dsfs_8/">Gradient Descent -- Data Science from Scratch (ch8)</a></li>
      
      <li><a href="/post/dsfs_5/">Data Science from Scratch (ch5) - Statistics</a></li>
      
    </ul>
  </div>
  




  </div>
</article>

      

    
    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js" integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js" integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js" integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin="anonymous"></script>

      

      
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/highlight.min.js" integrity="sha256-eOgo0OtLL4cdq7RdwRUiGKLX9XsIJ7nGhWEKbohmVAQ=" crossorigin="anonymous"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/languages/r.min.js"></script>
        
      

    

    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.5.1/leaflet.js" integrity="sha256-EErZamuLefUnbMBQbsEqu1USa+btR2oIlCpBJbyD4/g=" crossorigin="anonymous"></script>
    

    
    
    <script>const code_highlighting = true;</script>
    

    
    
    <script>const isSiteThemeDark = false;</script>
    

    
    
    
    
    
    
    <script>
      const search_config = {"indexURI":"/index.json","minLength":1,"threshold":0.3};
      const i18n = {"no_results":"No results found","placeholder":"Search...","results":"results found"};
      const content_type = {
        'post': "Posts",
        'project': "Projects",
        'publication' : "Publications",
        'talk' : "Talks"
        };
    </script>
    

    
    

    
    
    <script id="search-hit-fuse-template" type="text/x-template">
      <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
      </div>
    </script>
    

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.2.1/fuse.min.js" integrity="sha256-VzgmKYmhsGNNN4Ph1kMW+BjoYJM2jV5i4IlFoeZA9XI=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>
    

    
    

    
    

    
    

    
    
    
    
    
    
    
    
    
      
    
    
    
    
    <script src="/js/academic.min.37431be2d92d7fb0160054761ab79602.js"></script>

    






  
  
  <div class="container">
    <footer class="site-footer">
  
  <p class="powered-by">
    
      <a href="/privacy/">Privacy Policy</a>
    
    
       &middot; 
      <a href="/terms/">Terms</a>
    
  </p>
  

  <p class="powered-by">
    © 2020 Paul Apivat Hanvongse. All Rights Reserved.
  </p>

  
  






  <p class="powered-by">
    Powered by the
    <a href="https://sourcethemes.com/academic/" target="_blank" rel="noopener">Academic theme</a> for
    <a href="https://gohugo.io" target="_blank" rel="noopener">Hugo</a>.

    
    <span class="float-right" aria-hidden="true">
      <a href="#" class="back-to-top">
        <span class="button_icon">
          <i class="fas fa-chevron-up fa-2x"></i>
        </span>
      </a>
    </span>
    
  </p>
</footer>

  </div>
  

  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

</body>
</html>
